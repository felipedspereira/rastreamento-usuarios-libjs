var dbUtil=function(){var ACTIVITIES_ENTRY="activities";var EMAIL_ENTRY="email";var updateActivitiesInLocalstorage=function(activities){localStorage.setItem(ACTIVITIES_ENTRY,JSON.stringify(activities))};var getActivitiesFromLocalstorage=function(){return JSON.parse(localStorage.getItem(ACTIVITIES_ENTRY)||"[]")};var getUserEmail=function(){return localStorage.getItem(EMAIL_ENTRY)};var cleanLocalstorageActivities=function(activities){activities=[];localStorage.setItem(ACTIVITIES_ENTRY,JSON.stringify(activities))};var persistEmail=function(data){localStorage.setItem(EMAIL_ENTRY,data)};return{updateActivities:updateActivitiesInLocalstorage,getActivities:getActivitiesFromLocalstorage,getUserEmail:getUserEmail,cleanActivities:cleanLocalstorageActivities,persistEmail:persistEmail}}();var trackingJS=function(window,dbUtil){var url=null;var ACTIVITIES_ENTRY="activities";var EMAIL_ENTRY="email";window.addEventListener("load",function(){sendStatistic()});var sendStatistic=function(){if(url==null){throw"No url supplied to trackingJS. You need to call trackingJS(someUrl) in order to get trackingJS monitoring the activities navigation"}var activities=dbUtil.getActivities();activities.push({url:window.location.href,date:new Date});var userEmail=dbUtil.getUserEmail();if(userEmail){sendDataToBackend(userEmail,activities)}else{dbUtil.updateActivities(activities)}};var sendDataToBackend=function(userEmail,userActivities){var options={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({email:userEmail,activities:userActivities})};fetch(url,options).then(function(res){dbUtil.cleanActivities(userActivities)})};var config=function(backendTrackingServerUrl){url=backendTrackingServerUrl};var activateUser=function(data){dbUtil.persistEmail(data);console.log("usuario "+data+" ativado com sucesso ")};return{config:config,activateUser:activateUser}}(window,dbUtil);